#! /bin/env zsh

ips="${(@f)$( traceroute -q 1 www.bing.com | rg -i "^ " | rg -io "[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+\)" | rg -io "[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+" )}"

for ip in "${(@f)$( traceroute -q 1 www.google.com | rg -i "^ " | rg -io "[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+\)" | rg -io "[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+" )}"; do
  echo "Getting IP:$ip"
  res=$( GOSNMP_TARGET=$ip GOSNMP_PORT=161 go run snmp.go )
  # echo $res
  echo $res | rg "Parsed.*EngineID"
  echo $res | rg "Parsed.*EngineBoots"
  echo $res | rg "Parsed.*EngineTimes"
done

